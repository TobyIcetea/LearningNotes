# KubeEdge 学习笔记

## 为什么选择 KubeEdge

- 问：我在 KubeEdge 的网站上看到这样一句话：KubeEdge 将原生的容器化的业务流程和设备管理功能拓展到边缘节点。意思是，原本的 K8s 中，并不支持这样的功能，对吗？

    - 在原生的 K8s 中，并没有直接支持「设备管理」和「边缘节点」的功能。K8s 主要设计用于在数据中心或者云环境中管理容器化应用，但是在边缘计算场景中，通常有一些特殊的需求，比如管理和监控分布在各个边缘位置的设备，以及在网络连接不稳定的环境中保持应用的高效运行。
    - KubeEdge 的作用就是拓展 K8s 的功能，特别是以下几个方面：
        1. 设备管理：KubeEdge 提供了设备管理的能力，可以与边缘设备进行交互和管理，支持设别的状态监控、命令下发等功能。这在标准的 K8s 中并没有原生支持。
        2. 边缘节点管理：KubeEdge 允许将 Kubenetes 的控制平面延伸到边缘节点，这些节点可以与中心云环境分离或者间歇性链接。因此，边缘节点即使离线或者网络不稳定，仍然可以继续运行容器化的应用。
        3. 边缘计算优化：由于边缘计算场景对延迟、网络带宽和自主性有更高的要求，KubeEdge 还做了一些针对边缘场景的优化，帮助减少对中心云的以来，并提高边缘节点的自主运行能力。
    - 因此，KubeEdge 可以看做是对原生 K8s 能力的扩展，专门面向边缘计算场景，而这些功能在 K8s 自身并不是内置的。

    ### KubeEdge 的优势

KubeEdge 的优势主要包括：

- 边缘计算：借助在 Edge 上运行业务应用，可以在产生数据的边缘 存储和处理 大量数据。这样可以减少边缘和运之间的网络带宽需求和消耗，提高响应速度，降低成本并保护客户的数据隐私。
- 简化开发：开发人员可以编写基于 HTTP 或 MQTT 的常规应用程序，对其进行容器化，然后在 Edge 或者 Cloud 中的任何一个更合适的位置运行应用程序。
- K8s 原生支持：借助 KubeEdge，用户可以像在传统的 K8s 集群一样，在 Edge 节点上编排应用程序，管理设备并监视应用程序和设备状态。
- 丰富的应用：可以轻松地将现有的复杂机器学习、图像识别、事件处理等其他高级应用程序部署到 Edge。

### KubeEdge 的架构

![eae899aaff2a2240a36dfaf63f38228a](https://xubowen-bucket.oss-cn-beijing.aliyuncs.com/img/eae899aaff2a2240a36dfaf63f38228a.png)

其中：

- Edged：在边缘节点上运行并管理容器化应用程序的代理。
- EdgeHub：Web 套接字客户端，负责与 Cloud Service 进行交互以进行边缘计算（例如 KubeEdge 体系结构中的 Edge Controller）。这包括将云侧资源更新同步到边缘，并将边缘侧主机和设备状态变更报告给云。
- CloudHub：Web 套接字服务器，负责在云端缓存信息、监视变更，并向 EdgeHub 端发送消息。
- EdgeController：K8s 的扩展控制器，用于管理边缘节点和 pod 的元数据，以便可以将数据定位到对应的边缘节点。
- EventBus：一个与 MQTT 服务器（mosquitto）进行交互的 MQTT 客户端，为其他组件提供发布和订阅功能。
- DeviceTwin：负责存储设备状态并将设备状态同步到云端。它还为应用程序提供查询接口。
- MetaManager：Edged 端和 Edgehub 端之间的消息处理器。它还负责将元数据存储到轻量级数据库（SQLite）或从轻量级数据库（SQLite）检索元数据。
- ServiceBus：用于与 HTTP 服务器（REST）交互的 HTTP 客户端，为云组件提供 HTTP 客户端功能，以访问在边缘运行的 HTTP 服务器。
- DeviceController：一个扩展的 K8s 控制器，用于管理边缘 IoT 设备，以便设备元数据 / 状态数据可以在 edge 和 cloud 之间同步。







